---
title: javascript基础
date: 2020-12-02 21:11:17
tags: javascript基础
keywords: 执行上下文
categories: 笔记
---
> [javascript 高级](https://www.bilibili.com/video/BV1Mz4y1Q79G?p=27) 笔记
# 执行上下文
## 执行上下文
1. 代码分类
   * 全局代码
   * 函数代码（局部）

2. 全局执行上下文

     * 在执行全局代码前将window确定为全局执行上下文
     * 对全局数据进行预处理   变量提升
       * var 定义的全局变量==> undefined，添加为window的属性。
       * function声明的全局函数==> 赋值（fun）, 添加为window的方法。 同样会提升
       * this ==> 赋值window

    * 开始执行全局代码

3. 函数执行上下文

     * 在调用函数，准备执行函数体之前，创建对应的函数执行上下文对象（虚拟的，存在于栈里面）
     * 对局部数据进行预处理   函数提升
       * 形参变量 ==> 赋值（实参）==> 添加为执行上下文的属性
       * argument ==> 赋值(实参列表)， 添加为执行上下文的属性
       * var 定义的局部变量==> undefined, 添加为执行上下文的属性
       * function声明的函数 ==> 赋值（fun），添加为执行上下文的方法
       * this ==> 赋值（调用函数的对象） 

## 执行上下文栈
1. 在全局代码执行前，JS引擎就会创建一个栈来存储管理所有的执行上下文对象
2. 在全局执行上下文（window）确定后，将其添加到栈中（压栈）
3. 在函数执行上下文创建之后，将其添加到栈中（压栈）
4. 在当前函数执行完之后，将栈顶的对象移除（弹栈）
5. 当所有代码执行完之后，栈中只剩window

## 注意
 1. 先变量提升，再函数提升
 2. 初始化在所有变量提升之后

# 作用域与作用域链
## 作用域
1. 理解
   * 就是一块“地盘”，一个代码所在的区域。
   * 它是静态的（相对于全局上下文对象）， 在编写代码的时候就确定了

2. 分类
   * 全局作用域
   * 函数作用域
   * 没有块作用域（ES6有了）

3. 作用
   * 隔离变量，不同作用域下同名变量不会有冲突
## 作用域与执行上下文的区别
1. 区别1
   * 全局作用域外每个函数都会创建自己的作用域，作用域在函数定义时就已经确定了，而不是在调用时。
   * 全局执行上下文环境是在全局作用域确定之后，js代码马上执行之前创建
   * 函数执行上下文环境是在调用函数的时候，函数体代码执行之前创建

2. 区别2
   * 作用域是静态的，只要函数定义好了就一直存在，且不会发生变化
   * 上下文的环境是动态的，调用函数时创建，函数调用结束时上下文环境就会自动释放

3. 联系
   * 上下文环境（对象）是从属所在的作用域中
   * 全局上下文环境 ==> 全局作用域
   * 函数上下文环境 ==> 对应的函数使用域  

## 作用域链
1. 理解

   * 多个上下级关系的作用域形成的链，他的方向是从下向上的（从内到外）
   * 查找变量的时候沿着作用域链来查找的

2. 查找一个变量的查找规则
   * 在当前作用域的执行上下文中查找对应的属性如果有直接返回，否则进入2
   * 在上一级作用域的执行上下文中查找对应的属性，如果有直接返回，否则进入3
   * 再次执行2的相同操作，直到全局作用域，如果还找不到就抛出找不到的异常
 